{% extends "base.html" %}

{% load static from staticfiles %}

{% block title %}Lista de incidencias{% endblock %}

{% block extraCSS %}
    <link href="{% static "css/historial.css" %}" rel="stylesheet"  />
{% endblock %}

{% block content %}
    <h1 id="titulo"> Lista de Incidencias</h1>
    <div class="tabbable container">
        <ul class="nav nav-tabs" id="myTabs">
            {% if estados_all %}
                {% for est in estados_all %}
                    {% if forloop.first %}
                        <li href="#{{ est.id }}" class="active"><a>{{ est.nombre }}</a></li>
                    {% else %}
                        <li href="#{{ est.id }}" ><a>{{ est.nombre }}</a></li>
                    {% endif %}
                {% endfor %}
            {% else %}
                <li>No se han creado estados</li>
            {% endif %}
        </ul>

        <select class="form-control combo">
            {% if categorias_all %}
                {% for cat in categorias_all %}
                    <option value="{{ cat.id }}">{{ cat.nombre }}</option>
                {% endfor %}
            {% else %}
                <option value="1">No hay categorias a ense√±ar</option>
            {% endif %}
        </select>

        <div class="container" id="datos"></div>
    </div>
{% endblock %}

{% block extraScripts %}
    <script type="text/javascript">
        var MEDIA_URL = {{MEDIA_URL}};
    </script>
    <script>
        $(function() {
            $('#myTabs').bind('show', function(e) {
               var pattern=/#.+/gi //use regex to get anchor(==selector)
               var contentID = e.target.toString().match(pattern)[0]; //get anchor
               //load content for selected tab
                $(contentID).load(baseURL+contentID.replace('#',''), function(){
                    $('#myTabs').tab(); //reinitialize tabs
                });
            });
        });
    </script>
{% endblock %}